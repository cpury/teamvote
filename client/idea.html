<template name="listIdeas">
  {{> newIdea}}

  {{#if Template.subscriptionsReady}}
    {{#if ideas.count}}
      {{> orderBy}}

      <div class="panel-group idea-list" id="accordion">
        {{#with ideas}}
          {{#each ideas}}
            {{> idea}}
          {{/each}}
        {{/with}}
      </div>
    {{else}}
      {{> noIdeas}}
    {{/if}}
  {{else}}
    <p>Loading...</p>
  {{/if}}
</template>

<template name="noIdeas">
  <div class="text-center">
    <br />
    <br />
    <h1>No ideas yet!</h1>
    {{#if currentUser}}
      <h4>Share your ideas to start brainstorming!</h4>
    {{else}}
      <h4>Log in to start brainstorming!</h4>
    {{/if}}
  </div>
</template>

<template name="idea">
  <div id="panel-{{_id}}" class="panel panel-default">
    <div class="panel-heading clearfix">
      <div class="btn-group pull-right">
        <button type="button" class="btn btn-default"><i class="glyphicon glyphicon-user"></i> {{authorName}}</button>
        <button type="button" class="btn btn-default">
          <i class="glyphicon glyphicon-time"></i>
          {{livestamp createdAt}}
        </button>
        {{#if canDeleteIdea this}}
        <button type="button" class="btn btn-default delete-idea"><i class="glyphicon glyphicon-trash"></i></button>
        {{/if}}
      </div>

      <button type="button" class="btn btn-{{#if ideaIsUpvoted this}}success{{else}}default{{/if}} upvote-idea pull-left">
        <span class="glyphicon glyphicon-circle-arrow-up"></span>
        {{upvoteCount}}
      </button>

      <h4 class="panel-title pull-left idea-heading">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapse-{{_id}}">
          {{title}}
        </a>
      </h4>
    </div>

    <div id="collapse-{{_id}}" class="panel-collapse collapse">
      <div class="panel-body">
        {{#if description}}
          {{description}}
        {{else}}
        <em>(No description given.)</em>
        {{/if}}
        <div class="comments">
          <ul class="list-group">
            {{> newComment}}
            {{#each comments}}
              {{> comment}}
            {{/each}}
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>

<template name="newIdea">
  {{#if currentUser}}
  <form class="new-idea">
    <div class="form-group">
      <div class="input-group input-group-lg">
        <span class="input-group-addon large-input">ðŸ’¡</span>
        <input type="text" class="form-control large-input" placeholder="Add a new idea" name="title" maxlength="100">
      </div>

      <div class="input-group input-group-lg">
        <span class="input-group-addon large-input"><span class="glyphicon glyphicon-pencil"></span></span>
        <input type="text" class="form-control" placeholder="Add a description (optional)" name="description" maxlength="200">
      </div>
    </div>

    <button type="submit" class="btn btn-default hidden">Submit</button>
  </form>
  {{else}}
    <h4>Please log in to share your ideas.</h4>
  {{/if}}
</template>

<template name="orderBy">
  <form class="form-inline" id="order-by-form">
    <div class="form-group">
      <label for="orderby">Order by</label>
      <select class="form-control" id="orderby">
        <option {{isSelected "Newest"}}>Newest</option>
        <option {{isSelected "Oldest"}}>Oldest</option>
        <option {{isSelected "Upvotes"}}>Upvotes</option>
        <option {{isSelected "Comments"}}>Comments</option>
      </select>
    </div>
  </form>
</template>
